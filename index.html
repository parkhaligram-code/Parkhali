<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡¶™‡¶æ‡¶∞‡¶ñ‡¶æ‡¶≤‡ßÄ ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ</title>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <style>
        /* --- Premium CSS Variables & Reset --- */
        :root { 
            --primary-blue: #1565c0; --primary-green: #2e7d32; 
            --blood-red: #e53935; --emergency-orange: #fb8c00; --agri-green: #689f38; 
            --bg-color: #f4f7fa; --card-bg: #ffffff; 
            --text-main: #1e293b; --text-muted: #64748b; 
            --shadow-sm: 0 4px 6px -1px rgba(0,0,0,0.05);
            --shadow-md: 0 10px 15px -3px rgba(0,0,0,0.05);
            --shadow-lg: 0 20px 25px -5px rgba(0,0,0,0.1);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Hind Siliguri', 'Poppins', sans-serif; margin: 0; padding: 0; background-color: var(--bg-color); color: var(--text-main); overflow-x: hidden; }
        
        /* Main Container */
        .container { max-width: 480px; margin: 0 auto; background: var(--bg-color); min-height: 100vh; position: relative; padding-bottom: 85px; box-shadow: 0 0 20px rgba(0,0,0,0.05); }

        /* --- SPLASH SCREEN ANIMATION --- */
        #splash-screen {
            position: fixed; inset: 0; max-width: 480px; margin: 0 auto;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
            z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: opacity 0.6s ease-out, visibility 0.6s ease-out;
        }
        .splash-logo {
            font-size: 80px; color: white; margin-bottom: 10px;
            animation: pulse-logo 1.5s infinite ease-in-out;
        }
        .splash-text { color: white; font-size: 2rem; font-weight: 700; margin: 0; letter-spacing: 1px; }
        .splash-sub { color: rgba(255,255,255,0.8); font-size: 1.1rem; margin-top: 5px; }
        .spinner {
            width: 40px; height: 40px; border: 4px solid rgba(255,255,255,0.3);
            border-top-color: white; border-radius: 50%; margin-top: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes pulse-logo { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        @keyframes spin { to { transform: rotate(360deg); } }
        .splash-hidden { opacity: 0; visibility: hidden; pointer-events: none; }

        /* --- HEADER --- */
        header { 
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-green)); 
            color: white; padding: 2rem 1.5rem 3.5rem; 
            border-bottom-left-radius: 35px; border-bottom-right-radius: 35px; 
            box-shadow: var(--shadow-md); position: relative;
        }
        .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .header-top h1 { font-size: 1.5rem; font-weight: 700; margin: 0; display: flex; align-items: center; gap: 8px;}
        .logout-btn { background: rgba(255,255,255,0.2); color: white; border: none; padding: 8px 15px; cursor: pointer; border-radius: 20px; font-size: 0.9rem; font-weight: 600; display: none; align-items: center; gap: 5px; backdrop-filter: blur(5px); transition: 0.3s; }
        .logout-btn:active { transform: scale(0.95); }
        .hero-section h2 { font-size: 2rem; margin: 0 0 0.2rem 0; font-weight: 700; }
        .hero-section p { font-size: 1.05rem; opacity: 0.9; margin: 0; }

        /* --- MAIN CONTENT & CARDS --- */
        main { padding: 0 1.5rem; margin-top: -2.5rem; position: relative; z-index: 2; }
        .section-card { background: var(--card-bg); padding: 1.8rem; border-radius: 20px; box-shadow: var(--shadow-lg); margin-bottom: 1.5rem; transition: transform 0.3s ease; }
        .section-title { font-size: 1.25rem; color: var(--text-main); margin: 0 0 1.2rem 0; font-weight: 700; display: flex; align-items: center; gap: 8px;}
        
        /* --- FORMS & BUTTONS --- */
        .form-input { width: 100%; padding: 14px 16px; margin: 8px 0 16px; border: 1.5px solid #e2e8f0; border-radius: 12px; font-family: inherit; font-size: 1rem; background: #f8fafc; transition: all 0.3s; }
        .form-input:focus { border-color: var(--primary-blue); background: #fff; outline: none; box-shadow: 0 0 0 4px rgba(21,101,192,0.1); }
        
        .btn-primary { width: 100%; padding: 14px; background: linear-gradient(135deg, var(--primary-blue), var(--primary-green)); color: white; border: none; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1.1rem; letter-spacing: 0.5px; transition: 0.3s; box-shadow: 0 4px 12px rgba(46,125,50,0.3); }
        .btn-primary:active { transform: translateY(2px); box-shadow: none; }
        
        .toggle-auth { text-align: center; margin-top: 15px; font-size: 0.95rem; color: var(--text-muted); }
        .toggle-auth span { color: var(--primary-blue); font-weight: 700; cursor: pointer; }
        .msg { font-size: 0.9rem; margin-top: 10px; text-align: center; font-weight: 500; }
        .error { color: var(--blood-red); } .success { color: var(--primary-green); }

        /* --- SERVICES GRID --- */
        .services-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.2rem; }
        .service-item { display: flex; flex-direction: column; align-items: center; cursor: pointer; transition: 0.3s; padding: 10px 5px; border-radius: 16px; }
        .service-item:active { transform: scale(0.92); background: #f1f5f9; }
        .service-icon { width: 65px; height: 65px; border-radius: 20px; display: flex; align-items: center; justify-content: center; font-size: 32px; margin-bottom: 0.8rem; box-shadow: var(--shadow-sm); transition: 0.3s;}
        
        .icon-blood { background: #ffebee; color: var(--blood-red); }
        .icon-emergency { background: #fff3e0; color: var(--emergency-orange); }
        .icon-agri { background: #f1f8e9; color: var(--agri-green); }
        
        .service-label { font-size: 0.85rem; font-weight: 600; color: var(--text-main); text-align: center; }

        /* --- NOTICES --- */
        .notice-item { background: #fff; padding: 1.2rem; border-radius: 16px; margin-bottom: 1rem; border: 1px solid #f1f5f9; border-left: 5px solid var(--primary-blue); box-shadow: var(--shadow-sm); transition: 0.3s; }
        .notice-item:hover { box-shadow: var(--shadow-md); transform: translateY(-2px); }
        .notice-item h4 { margin: 0 0 0.5rem; color: var(--text-main); font-size: 1.15rem; font-weight: 700;}
        .notice-item p { margin: 0 0 0.8rem; font-size: 0.95rem; color: var(--text-muted); line-height: 1.5; }
        .notice-date { font-size: 0.8rem; color: #94a3b8; display: flex; align-items: center; gap: 5px; font-weight: 500;}

        /* --- BOTTOM NAV --- */
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; max-width: 480px; margin: 0 auto; background: rgba(255,255,255,0.9); backdrop-filter: blur(10px); display: none; justify-content: space-around; padding: 0.8rem 0; border-top-left-radius: 25px; border-top-right-radius: 25px; box-shadow: 0 -5px 20px rgba(0,0,0,0.06); z-index: 90; }
        .nav-item { color: #94a3b8; text-decoration: none; display: flex; flex-direction: column; align-items: center; font-size: 0.75rem; font-weight: 600; padding: 8px 16px; border-radius: 15px; cursor: pointer; transition: 0.3s; }
        .nav-item.active { color: var(--primary-blue); background: #eff6ff; }
        .nav-icon { font-size: 26px; margin-bottom: 4px; transition: 0.3s; }
        .nav-item.active .nav-icon { transform: translateY(-2px); }

        /* --- MODALS (Premium Bottom Sheet) --- */
        .modal-overlay { position: fixed; inset: 0; background: rgba(15, 23, 42, 0.6); backdrop-filter: blur(4px); z-index: 100; display: none; justify-content: center; align-items: flex-end; opacity: 0; transition: opacity 0.3s ease; }
        .modal-overlay.show { opacity: 1; }
        .modal-content { background: white; width: 100%; max-width: 480px; border-top-left-radius: 30px; border-top-right-radius: 30px; padding: 2rem 1.5rem; max-height: 85vh; overflow-y: auto; box-shadow: 0 -10px 40px rgba(0,0,0,0.2); transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .modal-overlay.show .modal-content { transform: translateY(0); }
        
        .modal-indicator { width: 50px; height: 5px; background: #e2e8f0; border-radius: 10px; margin: -10px auto 20px; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;}
        .modal-header h3 { margin: 0; display: flex; align-items: center; gap: 10px; font-size: 1.4rem; font-weight: 700; }
        .close-btn { background: #f1f5f9; border: none; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; cursor: pointer; color: var(--text-muted); transition: 0.3s; }
        .close-btn:active { background: #e2e8f0; transform: scale(0.9); }

        /* Lists in Modal */
        .contact-card { background: #fff; padding: 15px; border-radius: 16px; margin-bottom: 12px; border: 1px solid #f1f5f9; display: flex; justify-content: space-between; align-items: center; box-shadow: var(--shadow-sm); }
        .contact-info h5 { margin: 0 0 5px 0; font-size: 1.05rem; color: var(--text-main); font-weight: 600; }
        .contact-info p { margin: 0; font-size: 0.9rem; color: var(--text-muted); }
        .contact-badge { width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; border-radius: 14px; font-weight: 700; font-size: 1.1rem; color: white; }
        .call-btn { width: 45px; height: 45px; border-radius: 14px; display: flex; align-items: center; justify-content: center; text-decoration: none; color: white; background: #10b981; box-shadow: 0 4px 10px rgba(16,185,129,0.3); transition: 0.3s; }
        .call-btn:active { transform: scale(0.9); }

        /* User List in Admin */
        .user-manage-card { background: #f8fafc; border-radius: 12px; padding: 12px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #e2e8f0; }
        .badge { padding: 4px 10px; border-radius: 8px; font-size: 0.75rem; font-weight: 700; color: white; }
        .badge-active { background: #10b981; } .badge-banned { background: var(--blood-red); } .badge-admin { background: var(--primary-blue); }
        .btn-action { padding: 6px 12px; border: none; border-radius: 8px; cursor: pointer; font-size: 0.8rem; font-weight: 600; color: white; margin-left:5px; transition:0.2s;}
        .btn-warning { background: var(--emergency-orange); } .btn-danger { background: var(--blood-red); } .btn-success { background: #10b981; }
        .btn-action:active { transform: scale(0.9); }
    </style>
</head>
<body>

    <div id="splash-screen">
        <span class="material-icons-round splash-logo">holiday_village</span>
        <h1 class="splash-text">‡¶™‡¶æ‡¶∞‡¶ñ‡¶æ‡¶≤‡ßÄ</h1>
        <p class="splash-sub">‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶æ‡¶≤</p>
        <div class="spinner"></div>
    </div>

    <div class="container">
        <header>
            <div class="header-top">
                <h1><span class="material-icons-round" style="font-size: 28px;">widgets</span> ‡¶™‡¶æ‡¶∞‡¶ñ‡¶æ‡¶≤‡ßÄ</h1>
                <button id="logout-btn" class="logout-btn"><span class="material-icons-round" style="font-size: 18px;">power_settings_new</span> ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</button>
            </div>
            <div class="hero-section" id="hero-text">
                <h2>‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ!</h2>
                <p>‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶∏‡ßá‡¶¨‡¶æ‡¶Ø‡¶º ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡•§</p>
            </div>
        </header>

        <main>
            <section id="auth-section" class="section-card" style="display: none;">
                <h3 id="form-title" class="section-title" style="justify-content: center; font-size: 1.5rem;">‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
                <input type="email" id="email" class="form-input" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡ßç‡¶∞‡ßá‡¶∏" required>
                <input type="password" id="password" class="form-input" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°" required>
                <button id="auth-action-btn" class="btn-primary">‡¶≤‡¶ó‡¶á‡¶®</button>
                <p class="toggle-auth" id="toggle-auth">‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ? <span>‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</span></p>
                <p id="auth-msg" class="msg"></p>
            </section>

            <div id="home-view" style="display: none;">
                <section class="section-card">
                    <h3 class="section-title">‡¶ú‡¶®‡¶™‡ßç‡¶∞‡¶ø‡ßü ‡¶∏‡ßá‡¶¨‡¶æ‡¶∏‡¶Æ‡ßÇ‡¶π</h3>
                    <div class="services-grid">
                        <div class="service-item" id="btn-blood-donor">
                            <div class="service-icon icon-blood"><span class="material-icons-round">bloodtype</span></div>
                            <div class="service-label">‡¶¨‡ßç‡¶≤‡¶æ‡¶° ‡¶°‡ßã‡¶®‡¶æ‡¶∞</div>
                        </div>
                        <div class="service-item" id="btn-emergency">
                            <div class="service-icon icon-emergency"><span class="material-icons-round">support_agent</span></div>
                            <div class="service-label">‡¶ú‡¶∞‡ßÅ‡¶∞‡ßÄ ‡¶∏‡ßá‡¶¨‡¶æ</div>
                        </div>
                        <div class="service-item" id="btn-agriculture">
                            <div class="service-icon icon-agri"><span class="material-icons-round">agriculture</span></div>
                            <div class="service-label">‡¶ï‡ßÉ‡¶∑‡¶ø ‡¶§‡¶•‡ßç‡¶Ø</div>
                        </div>
                    </div>
                </section>

                <section class="section-card">
                    <h3 class="section-title"><span class="material-icons-round" style="color:var(--primary-blue);">campaign</span> ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡ßã‡¶∞‡ßç‡¶°</h3>
                    <div id="notice-container">
                        <div style="padding: 20px; text-align: center; color: var(--text-muted);">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
                    </div>
                </section>
            </div>

            <div id="profile-view" style="display: none;">
                <section class="section-card" style="text-align: center; background: linear-gradient(to bottom, #eff6ff, white);">
                    <div style="width: 90px; height: 90px; background: var(--primary-blue); color: white; font-size: 45px; display: flex; align-items: center; justify-content: center; border-radius: 50%; margin: 0 auto 15px; box-shadow: 0 10px 20px rgba(21,101,192,0.2);">
                        <span class="material-icons-round">person</span>
                    </div>
                    <h3 style="margin: 0 0 5px 0; font-size: 1.4rem; font-weight: 700;" id="profile-display-name">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤</h3>
                    <p style="color: var(--text-muted); font-size: 0.95rem; margin: 0;" id="profile-display-email"></p>
                </section>

                <section class="section-card">
                    <h4 style="margin: 0 0 15px 0; color: var(--text-main); font-size: 1.1rem;">‡¶§‡¶•‡ßç‡¶Ø ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</h4>
                    <input type="text" id="profile-name" class="form-input" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡¶æ‡¶Æ">
                    <input type="tel" id="profile-phone" class="form-input" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞">
                    <input type="text" id="profile-address" class="form-input" placeholder="‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶™‡¶æ‡ßú‡¶æ/‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°">
                    <button id="update-profile-btn" class="btn-primary" style="margin-top: 10px;">‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                    <p id="profile-msg" class="msg"></p>
                </section>
            </div>

            <div id="admin-view" style="display: none;">
                <section class="section-card" style="border: 2px solid #e0f2fe; background: #f8fafc;">
                    <h3 class="section-title" style="color: var(--primary-blue);"><span class="material-icons-round">admin_panel_settings</span> ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶∞‡ßÅ‡¶Æ</h3>
                    
                    <div style="background: white; padding: 20px; border-radius: 16px; box-shadow: var(--shadow-sm); margin-bottom: 20px;">
                        <h4 style="margin: 0 0 15px 0; font-size: 1.1rem;">‡¶®‡¶§‡ßÅ‡¶® ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®</h4>
                        <input type="text" id="notice-title" class="form-input" placeholder="‡¶®‡ßã‡¶ü‡¶ø‡¶∂‡ßá‡¶∞ ‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ">
                        <textarea id="notice-desc" class="form-input" rows="3" placeholder="‡¶®‡ßã‡¶ü‡¶ø‡¶∂‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§..."></textarea>
                        <button id="publish-btn" class="btn-primary" style="background: var(--primary-blue);">‡¶™‡¶æ‡¶¨‡¶≤‡¶ø‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                    </div>

                    <div style="background: white; padding: 20px; border-radius: 16px; box-shadow: var(--shadow-sm);">
                        <h4 style="margin: 0 0 15px 0; display: flex; align-items: center; gap: 8px;">
                            <span class="material-icons-round">manage_accounts</span> ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü
                        </h4>
                        <input type="text" id="search-user" class="form-input" placeholder="‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¶‡¶ø‡ßü‡ßá ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®...">
                        <div id="admin-user-list" style="margin-top: 15px; max-height: 400px; overflow-y: auto;">
                            <p style="text-align:center; color: var(--text-muted);">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <nav class="bottom-nav" id="bottom-nav">
            <div class="nav-item active" id="nav-btn-home">
                <span class="material-icons-round nav-icon">home</span> ‡¶π‡ßã‡¶Æ
            </div>
            <div class="nav-item" id="nav-btn-admin" style="display: none;">
                <span class="material-icons-round nav-icon">admin_panel_settings</span> ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶®
            </div>
            <div class="nav-item" id="nav-btn-profile">
                <span class="material-icons-round nav-icon">person</span> ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤
            </div>
        </nav>

        <div id="blood-donor-modal" class="modal-overlay">
            <div class="modal-content">
                <div class="modal-indicator"></div>
                <div class="modal-header">
                    <h3 style="color: var(--blood-red);"><span class="material-icons-round">bloodtype</span> ‡¶∞‡¶ï‡ßç‡¶§‡¶¶‡¶æ‡¶§‡¶æ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h3>
                    <button class="close-btn" onclick="closeModal('blood-donor-modal')"><span class="material-icons-round">close</span></button>
                </div>
                
                <div style="background: #fff5f5; padding: 15px; border-radius: 16px; margin-bottom: 20px; border: 1px solid #fed7d7;">
                    <h4 style="color: var(--blood-red); margin: 0 0 10px 0;">‡¶®‡¶ø‡¶ú‡ßá‡¶ï‡ßá ‡¶°‡ßã‡¶®‡¶æ‡¶∞ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®</h4>
                    <input type="text" id="donor-name" class="form-input" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßÅ‡¶∞‡ßã ‡¶®‡¶æ‡¶Æ">
                    <select id="donor-group" class="form-input">
                        <option value="">‡¶∞‡¶ï‡ßç‡¶§‡ßá‡¶∞ ‡¶ó‡ßç‡¶∞‡ßÅ‡¶™...</option>
                        <option value="A+">A+</option><option value="A-">A-</option>
                        <option value="B+">B+</option><option value="B-">B-</option>
                        <option value="O+">O+</option><option value="O-">O-</option>
                        <option value="AB+">AB+</option><option value="AB-">AB-</option>
                    </select>
                    <input type="tel" id="donor-phone" class="form-input" placeholder="‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞">
                    <button id="add-donor-btn" class="btn-primary" style="background: var(--blood-red);">‡¶≤‡¶ø‡¶∏‡ßç‡¶ü‡ßá ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                    <p id="donor-msg" class="msg"></p>
                </div>

                <div>
                    <h4 style="margin-bottom: 10px; font-size: 1.1rem;">‡¶°‡ßã‡¶®‡¶æ‡¶∞ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®</h4>
                    <select id="filter-group" class="form-input">
                        <option value="All">‡¶∏‡¶¨ ‡¶ó‡ßç‡¶∞‡ßÅ‡¶™‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</option>
                        <option value="A+">A+</option><option value="A-">A-</option>
                        <option value="B+">B+</option><option value="B-">B-</option>
                        <option value="O+">O+</option><option value="O-">O-</option>
                        <option value="AB+">AB+</option><option value="AB-">AB-</option>
                    </select>
                    <div id="donor-list-container" style="margin-top: 15px;"></div>
                </div>
            </div>
        </div>

        <div id="emergency-modal" class="modal-overlay">
            <div class="modal-content">
                <div class="modal-indicator"></div>
                <div class="modal-header">
                    <h3 style="color: var(--emergency-orange);"><span class="material-icons-round">support_agent</span> ‡¶ú‡¶∞‡ßÅ‡¶∞‡ßÄ ‡¶∏‡ßá‡¶¨‡¶æ</h3>
                    <button class="close-btn" onclick="closeModal('emergency-modal')"><span class="material-icons-round">close</span></button>
                </div>
                <p style="font-size: 0.95rem; color: var(--text-muted); margin-bottom: 20px;">‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶®‡ßá ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã‡¶§‡ßá ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶ï‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®:</p>
                
                <div class="contact-card">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div class="contact-badge" style="background: #ef4444;"><span class="material-icons-round">local_police</span></div>
                        <div class="contact-info"><h5>‡¶ú‡¶æ‡¶§‡ßÄ‡ßü ‡¶ú‡¶∞‡ßÅ‡¶∞‡ßÄ ‡¶∏‡ßá‡¶¨‡¶æ</h5><p>‡¶™‡ßÅ‡¶≤‡¶ø‡¶∂, ‡¶´‡¶æ‡ßü‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏, ‡¶è‡¶Æ‡ßç‡¶¨‡ßÅ‡¶≤‡ßá‡¶®‡ßç‡¶∏</p></div>
                    </div>
                    <a href="tel:999" class="call-btn"><span class="material-icons-round">call</span></a>
                </div>
                <div class="contact-card">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div class="contact-badge" style="background: var(--primary-blue);"><span class="material-icons-round">person</span></div>
                        <div class="contact-info"><h5>‡¶á‡¶â‡¶®‡¶ø‡¶Ø‡¶º‡¶® ‡¶ö‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®</h5><p>‡¶Æ‡ßã‡¶É ‡¶Ü‡¶¨‡ßç‡¶¶‡ßÅ‡¶∞ ‡¶∞‡¶π‡¶Æ‡¶æ‡¶®</p></div>
                    </div>
                    <a href="tel:01700000000" class="call-btn" style="background: var(--primary-blue);"><span class="material-icons-round">call</span></a>
                </div>
                <div class="contact-card">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div class="contact-badge" style="background: var(--primary-green);"><span class="material-icons-round">health_and_safety</span></div>
                        <div class="contact-info"><h5>‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞</h5><p>‡¶°‡¶æ‡¶É ‡¶∞‡¶´‡¶ø‡¶ï‡ßÅ‡¶≤ ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ</p></div>
                    </div>
                    <a href="tel:01800000000" class="call-btn"><span class="material-icons-round">call</span></a>
                </div>
            </div>
        </div>

        <div id="agriculture-modal" class="modal-overlay">
            <div class="modal-content">
                <div class="modal-indicator"></div>
                <div class="modal-header">
                    <h3 style="color: var(--agri-green);"><span class="material-icons-round">agriculture</span> ‡¶ï‡ßÉ‡¶∑‡¶ø ‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂</h3>
                    <button class="close-btn" onclick="closeModal('agriculture-modal')"><span class="material-icons-round">close</span></button>
                </div>
                
                <div style="background: #f0fdf4; padding: 15px; border-radius: 16px; margin-bottom: 20px; border: 1px solid #bbf7d0;">
                    <h4 style="color: var(--agri-green); margin: 0 0 8px 0;">üåæ ‡¶ö‡¶≤‡¶§‡¶ø ‡¶Æ‡ßå‡¶∏‡ßÅ‡¶Æ‡ßá‡¶∞ ‡¶ü‡¶ø‡¶™‡¶∏</h4>
                    <p style="font-size: 0.95rem; margin: 0; color: #166534; line-height: 1.5;">‡¶è‡¶ñ‡¶® ‡¶¨‡ßã‡¶∞‡ßã ‡¶ß‡¶æ‡¶®‡ßá‡¶∞ ‡¶Æ‡ßå‡¶∏‡ßÅ‡¶Æ‡•§ ‡¶ú‡¶Æ‡¶ø‡¶§‡ßá ‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶§ ‡¶∏‡ßá‡¶ö ‡¶¶‡¶ø‡¶® ‡¶è‡¶¨‡¶Ç ‡¶™‡ßã‡¶ï‡¶æ ‡¶¶‡¶Æ‡¶®‡ßá ‡¶Ö‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶ø‡¶§ ‡¶ï‡ßÄ‡¶ü‡¶®‡¶æ‡¶∂‡¶ï ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
                </div>
                <h4 style="margin-bottom: 15px;">‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</h4>
                <div class="contact-card">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div class="contact-badge" style="background: var(--agri-green);"><span class="material-icons-round">support_agent</span></div>
                        <div class="contact-info"><h5>‡¶ï‡ßÉ‡¶∑‡¶ø ‡¶ï‡¶≤ ‡¶∏‡ßá‡¶®‡ßç‡¶ü‡¶æ‡¶∞</h5><p>‡¶ü‡ßã‡¶≤ ‡¶´‡ßç‡¶∞‡¶ø (‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø)</p></div>
                    </div>
                    <a href="tel:16123" class="call-btn" style="background: var(--agri-green);"><span class="material-icons-round">call</span></a>
                </div>
            </div>
        </div>

    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs, getDoc, doc, setDoc, updateDoc, deleteDoc, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAuqcDRrtuQi2tdWXA2E_UWyq7pCrGpoy4",
            authDomain: "parkhali-village.firebaseapp.com",
            projectId: "parkhali-village"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const adminEmail = "admin@parkhali.com";

        // Global Modal Functions for Inline HTML calls
        window.openModal = (id) => {
            const modal = document.getElementById(id);
            modal.style.display = 'flex';
            setTimeout(() => modal.classList.add('show'), 10);
        };
        window.closeModal = (id) => {
            const modal = document.getElementById(id);
            modal.classList.remove('show');
            setTimeout(() => modal.style.display = 'none', 300);
        };

        // UI Variables
        const splashScreen = document.getElementById('splash-screen');
        const authSection = document.getElementById('auth-section');
        const homeView = document.getElementById('home-view');
        const adminView = document.getElementById('admin-view');
        const profileView = document.getElementById('profile-view');
        const bottomNav = document.getElementById('bottom-nav');
        
        // --- Navigation Logic ---
        function switchView(viewName) {
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            homeView.style.display = 'none'; adminView.style.display = 'none'; profileView.style.display = 'none';

            if(viewName === 'home') {
                homeView.style.display = 'block'; document.getElementById('nav-btn-home').classList.add('active');
                document.getElementById('hero-text').innerHTML = `<h2>‡¶π‡ßç‡¶Ø‡¶æ‡¶≤‡ßã!</h2><p>${auth.currentUser ? auth.currentUser.email.split('@')[0] : '‡¶á‡¶â‡¶ú‡¶æ‡¶∞'}</p>`;
            } else if(viewName === 'admin') {
                adminView.style.display = 'block'; document.getElementById('nav-btn-admin').classList.add('active');
                document.getElementById('hero-text').innerHTML = `<h2>‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶∞‡ßÅ‡¶Æ</h2><p>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</p>`;
                loadAllUsers();
            } else if(viewName === 'profile') {
                profileView.style.display = 'block'; document.getElementById('nav-btn-profile').classList.add('active');
                document.getElementById('hero-text').innerHTML = `<h2>‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤</h2><p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø</p>`;
                loadProfileData();
            }
        }
        document.getElementById('nav-btn-home').addEventListener('click', () => switchView('home'));
        document.getElementById('nav-btn-admin').addEventListener('click', () => switchView('admin'));
        document.getElementById('nav-btn-profile').addEventListener('click', () => switchView('profile'));

        // --- Auth State & Splash Screen Logic ---
        let authStateResolved = false;
        
        // Hide splash after minimum 2 seconds OR when Firebase auth resolves (whichever is later)
        const minSplashTime = new Promise(resolve => setTimeout(resolve, 2000));
        
        onAuthStateChanged(auth, async (user) => {
            authStateResolved = true;
            await minSplashTime; // Wait for minimum animation time
            splashScreen.classList.add('splash-hidden'); // Fade out splash

            if (user) {
                // Check if Banned
                const userDoc = await getDoc(doc(db, "users", user.uid));
                if (userDoc.exists() && userDoc.data().status === "banned" && user.email !== adminEmail) {
                    signOut(auth); alert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶ü‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶¶‡ßç‡¶¨‡¶æ‡¶∞‡¶æ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!"); return;
                }
                
                authSection.style.display = "none";
                document.getElementById('logout-btn').style.display = "flex";
                bottomNav.style.display = "flex";
                document.getElementById('nav-btn-admin').style.display = (user.email === adminEmail) ? "flex" : "none";
                switchView('home');
                loadNotices();
            } else {
                authSection.style.display = "block";
                homeView.style.display = "none"; adminView.style.display = "none"; profileView.style.display = "none";
                document.getElementById('logout-btn').style.display = "none"; bottomNav.style.display = "none";
                document.getElementById('hero-text').innerHTML = `<h2>‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ!</h2><p>‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶∏‡ßá‡¶¨‡¶æ‡¶Ø‡¶º ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡•§</p>`;
            }
        });

        // Auth Buttons
        let isLogin = true;
        document.getElementById('toggle-auth').addEventListener('click', () => {
            isLogin = !isLogin;
            document.getElementById('form-title').innerText = isLogin ? "‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®" : "‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®";
            document.getElementById('auth-action-btn').innerText = isLogin ? "‡¶≤‡¶ó‡¶á‡¶®" : "‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶∞";
            document.getElementById('toggle-auth').innerHTML = isLogin ? '‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ? <span>‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</span>' : '‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶Ü‡¶õ‡ßá? <span>‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</span>';
        });

        document.getElementById('auth-action-btn').addEventListener('click', async () => {
            const email = document.getElementById('email').value; const pass = document.getElementById('password').value;
            const msg = document.getElementById('auth-msg');
            if(!email || !pass) { msg.className="msg error"; msg.innerText="‡¶∏‡¶¨ ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶®!"; return; }
            msg.className="msg"; msg.style.color="var(--primary-blue)"; msg.innerText="‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®...";
            try {
                if(isLogin) await signInWithEmailAndPassword(auth, email, pass);
                else {
                    const cred = await createUserWithEmailAndPassword(auth, email, pass);
                    await setDoc(doc(db, "users", cred.user.uid), { email: email, role: email===adminEmail?"admin":"user", status: "active", createdAt: serverTimestamp() });
                }
            } catch(e) { msg.className="msg error"; msg.innerText = "‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡ßü‡ßá‡¶õ‡ßá! ‡¶∏‡¶†‡¶ø‡¶ï ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶®‡•§"; }
        });
        document.getElementById('logout-btn').addEventListener('click', () => signOut(auth));

        // --- Modals Triggers ---
        document.getElementById('btn-blood-donor').addEventListener('click', () => { window.openModal('blood-donor-modal'); loadDonors(); });
        document.getElementById('btn-emergency').addEventListener('click', () => window.openModal('emergency-modal'));
        document.getElementById('btn-agriculture').addEventListener('click', () => window.openModal('agriculture-modal'));

        // --- Blood Donor Logic ---
        document.getElementById('add-donor-btn').addEventListener('click', async () => {
            const name = document.getElementById('donor-name').value; const group = document.getElementById('donor-group').value; const phone = document.getElementById('donor-phone').value;
            if(!name || !group || !phone) return alert("‡¶∏‡¶¨ ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶®!");
            try {
                await addDoc(collection(db, "blood_donors"), { name, bloodGroup: group, phone, addedBy: auth.currentUser.email, createdAt: serverTimestamp() });
                alert("‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!"); document.getElementById('donor-name').value=""; document.getElementById('donor-group').value=""; document.getElementById('donor-phone').value="";
                loadDonors(document.getElementById('filter-group').value);
            } catch (e) { alert("‡¶è‡¶∞‡¶∞: " + e.message); }
        });

        async function loadDonors(filter = "All") {
            const container = document.getElementById('donor-list-container'); container.innerHTML = `<p style="text-align:center;">‡¶ñ‡ßã‡¶Å‡¶ú‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>`;
            try {
                const snap = await getDocs(query(collection(db, "blood_donors"), orderBy("createdAt", "desc")));
                container.innerHTML = ""; let count = 0;
                snap.forEach(doc => {
                    const d = doc.data();
                    if(filter === "All" || d.bloodGroup === filter) {
                        count++;
                        container.innerHTML += `
                        <div class="contact-card">
                            <div style="display:flex; align-items:center; gap:15px;">
                                <div class="contact-badge" style="background:var(--blood-red)">${d.bloodGroup}</div>
                                <div class="contact-info"><h5>${d.name}</h5><p>${d.phone}</p></div>
                            </div>
                            <a href="tel:${d.phone}" class="call-btn"><span class="material-icons-round">call</span></a>
                        </div>`;
                    }
                });
                if(count===0) container.innerHTML="<p style='text-align:center;'>‡¶è‡¶á ‡¶ó‡ßç‡¶∞‡ßÅ‡¶™‡ßá‡¶∞ ‡¶°‡ßã‡¶®‡¶æ‡¶∞ ‡¶®‡ßá‡¶á‡•§</p>";
            } catch(e) {}
        }
        document.getElementById('filter-group').addEventListener('change', (e) => loadDonors(e.target.value));

        // --- Profile Logic ---
        async function loadProfileData() {
            if(!auth.currentUser) return;
            document.getElementById('profile-display-email').innerText = auth.currentUser.email;
            const docSnap = await getDoc(doc(db, "users", auth.currentUser.uid));
            if (docSnap.exists()) {
                const data = docSnap.data();
                document.getElementById('profile-name').value = data.name || "";
                document.getElementById('profile-phone').value = data.phone || "";
                document.getElementById('profile-address').value = data.address || "";
                if(data.name) document.getElementById('profile-display-name').innerText = data.name;
            }
        }
        document.getElementById('update-profile-btn').addEventListener('click', async () => {
            const name = document.getElementById('profile-name').value; const phone = document.getElementById('profile-phone').value; const address = document.getElementById('profile-address').value;
            try {
                await updateDoc(doc(db, "users", auth.currentUser.uid), { name, phone, address });
                alert("‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡ßü‡ßá‡¶õ‡ßá!"); document.getElementById('profile-display-name').innerText = name;
            } catch (e) { alert("‡¶è‡¶∞‡¶∞: " + e.message); }
        });

        // --- Admin Notices & Users ---
        document.getElementById('publish-btn').addEventListener('click', async () => {
            const title = document.getElementById('notice-title').value; const desc = document.getElementById('notice-desc').value;
            if(!title || !desc) return alert("‡¶∏‡¶¨ ‡¶ò‡¶∞ ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®!");
            await addDoc(collection(db, "notices"), { title, description: desc, createdAt: serverTimestamp() });
            alert("‡¶™‡¶æ‡¶¨‡¶≤‡¶ø‡¶∂ ‡¶π‡ßü‡ßá‡¶õ‡ßá!"); document.getElementById('notice-title').value=""; document.getElementById('notice-desc').value=""; loadNotices();
        });

        async function loadNotices() {
            const container = document.getElementById('notice-container');
            const snap = await getDocs(query(collection(db, "notices"), orderBy("createdAt", "desc")));
            container.innerHTML = "";
            if(snap.empty) { container.innerHTML="<p style='text-align:center;'>‡¶ï‡ßã‡¶®‡ßã ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶®‡ßá‡¶á‡•§</p>"; return; }
            snap.forEach(doc => {
                const n = doc.data(); const d = n.createdAt ? n.createdAt.toDate().toLocaleDateString('bn-BD') : '';
                container.innerHTML += `<div class="notice-item"><h4>${n.title}</h4><p>${n.description}</p><div class="notice-date"><span class="material-icons-round" style="font-size:14px;">schedule</span> ${d}</div></div>`;
            });
        }

        let allUsersData = [];
        async function loadAllUsers() {
            const container = document.getElementById('admin-user-list'); container.innerHTML="<p style='text-align:center;'>‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>";
            try {
                const snap = await getDocs(collection(db, "users")); allUsersData = [];
                snap.forEach(doc => allUsersData.push({ id: doc.id, ...doc.data() }));
                renderUsers(allUsersData);
            } catch(e) {}
        }
        function renderUsers(users) {
            const container = document.getElementById('admin-user-list'); container.innerHTML="";
            users.forEach(u => {
                const isBanned = u.status === "banned"; const isAdmin = u.role === "admin";
                let badge = isAdmin ? `<span class="badge badge-admin">Admin</span>` : (isBanned ? `<span class="badge badge-banned">Banned</span>` : `<span class="badge badge-active">Active</span>`);
                let btns = isAdmin ? '' : (isBanned ? `<button class="btn-action btn-success" onclick="window.unbanUser('${u.id}')">Unban</button>` : `<button class="btn-action btn-warning" onclick="window.banUser('${u.id}')">Ban</button>`) + `<button class="btn-action btn-danger" onclick="window.deleteUserData('${u.id}')">Del</button>`;
                container.innerHTML += `<div class="user-manage-card"><div><h5 style="margin:0 0 5px; font-size:0.95rem;">${u.email}</h5>${badge}</div><div>${btns}</div></div>`;
            });
        }
        document.getElementById('search-user').addEventListener('input', (e) => renderUsers(allUsersData.filter(u => u.email && u.email.toLowerCase().includes(e.target.value.toLowerCase()))));
        
        window.banUser = async (uid) => { if(confirm("‡¶¨‡ßç‡¶Ø‡¶æ‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?")) { await updateDoc(doc(db, "users", uid), { status: "banned" }); loadAllUsers(); }};
        window.unbanUser = async (uid) => { await updateDoc(doc(db, "users", uid), { status: "active" }); loadAllUsers(); };
        window.deleteUserData = async (uid) => { if(confirm("‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?")) { await deleteDoc(doc(db, "users", uid)); loadAllUsers(); }};

    </script>
</body>
</html>
